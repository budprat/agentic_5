/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/websockets/legacy/__init__.py:6: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
  warnings.warn(  # deprecated in 14.0 - 2024-11-09
/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/uvicorn/protocols/websockets/websockets_impl.py:17: DeprecationWarning: websockets.server.WebSocketServerProtocol is deprecated
  from websockets.server import WebSocketServerProtocol
INFO:     Started server process [29493]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://localhost:10101 (Press CTRL+C to quit)
INFO:     ::1:34456 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:54:38] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:44562 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:58:42] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:54200 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:58:50] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:54204 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:58:58] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:54204 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:59:04] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:41480 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:59:13] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:50678 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:59:23] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:39294 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:59:32] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:39294 - "POST / HTTP/1.1" 200 OK
[06/26/25 17:59:39] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
[06/26/25 17:59:44] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Calling 'find_agent' tool with query:  client.py:92
                             'Book round-trip economy class air                 
                             tickets from San...'                               
ERROR:    Exception in ASGI application
  + Exception Group Traceback (most recent call last):
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/uvicorn/protocols/http/h11_impl.py", line 403, in run_asgi
  |     result = await app(  # type: ignore[func-returns-value]
  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
  |     return await self.app(scope, receive, send)
  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/applications.py", line 112, in __call__
  |     await self.middleware_stack(scope, receive, send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 187, in __call__
  |     raise exc
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 165, in __call__
  |     await self.app(scope, receive, _send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
  |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
  |     raise exc
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
  |     await app(scope, receive, sender)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/routing.py", line 714, in __call__
  |     await self.middleware_stack(scope, receive, send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/routing.py", line 734, in app
  |     await route.handle(scope, receive, send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/routing.py", line 288, in handle
  |     await self.app(scope, receive, send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/routing.py", line 76, in app
  |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
  |     raise exc
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
  |     await app(scope, receive, sender)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/starlette/routing.py", line 74, in app
  |     await response(scope, receive, send)
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/sse_starlette/sse.py", line 237, in __call__
  |     async with anyio.create_task_group() as task_group:
  |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/anyio/_backends/_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/sse_starlette/sse.py", line 240, in cancel_on_finish
    |     await coro()
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/sse_starlette/sse.py", line 159, in _stream_response
    |     async for data in self.body_iterator:
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/a2a/server/apps/jsonrpc/jsonrpc_app.py", line 350, in event_generator
    |     async for item in stream:
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/a2a/server/request_handlers/jsonrpc_handler.py", line 121, in on_message_send_stream
    |     async for event in self.request_handler.on_message_send_stream(
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/a2a/server/request_handlers/default_request_handler.py", line 332, in on_message_send_stream
    |     await self._cleanup_producer(producer_task, task_id)
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/a2a/utils/telemetry.py", line 161, in async_wrapper
    |     result = await func(*args, **kwargs)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/a2a/server/request_handlers/default_request_handler.py", line 347, in _cleanup_producer
    |     await producer_task
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/a2a/utils/telemetry.py", line 161, in async_wrapper
    |     result = await func(*args, **kwargs)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/a2a/server/request_handlers/default_request_handler.py", line 159, in _run_event_stream
    |     await self.agent_executor.execute(request, queue)
    |   File "/home/coder/project/a2a-mcp/src/a2a_mcp/common/agent_executor.py", line 51, in execute
    |     async for item in self.agent.stream(query, task.contextId, task.id):
    |   File "/home/coder/project/a2a-mcp/src/a2a_mcp/agents/parallel_orchestrator_agent.py", line 300, in stream
    |     summary = await self.generate_summary()
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/src/a2a_mcp/agents/parallel_orchestrator_agent.py", line 46, in generate_summary
    |     response = client.models.generate_content(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/google/genai/models.py", line 5892, in generate_content
    |     response = self._generate_content(
    |                ^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/google/genai/models.py", line 4832, in _generate_content
    |     response = self._api_client.request(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/google/genai/_api_client.py", line 986, in request
    |     response = self._request(http_request, stream=False)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/google/genai/_api_client.py", line 879, in _request
    |     return self._retry(self._request_once, http_request, stream)  # type: ignore[no-any-return]
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/tenacity/__init__.py", line 475, in __call__
    |     do = self.iter(retry_state=retry_state)
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    |     result = action(retry_state)
    |              ^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    |     raise retry_exc.reraise()
    |           ^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    |     raise self.last_attempt.result()
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    |     return self.__get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/usr/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    |     raise self._exception
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/tenacity/__init__.py", line 478, in __call__
    |     result = fn(*args, **kwargs)
    |              ^^^^^^^^^^^^^^^^^^^
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/google/genai/_api_client.py", line 869, in _request_once
    |     errors.APIError.raise_for_response(response)
    |   File "/home/coder/project/a2a-mcp/.venv/lib/python3.11/site-packages/google/genai/errors.py", line 104, in raise_for_response
    |     raise ClientError(status_code, response_json, response)
    | google.genai.errors.ClientError: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits.', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_content_free_tier_requests', 'quotaId': 'GenerateRequestsPerMinutePerProjectPerModel-FreeTier', 'quotaDimensions': {'location': 'global', 'model': 'gemini-2.0-flash'}, 'quotaValue': '15'}]}, {'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.RetryInfo', 'retryDelay': '12s'}]}}
    +------------------------------------
INFO:     ::1:54260 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:03:39] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:54260 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:03:45] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:57154 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:03:53] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:57154 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:03:58] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:37574 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:04:09] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:45962 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:29:57] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:45962 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:30:04] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
INFO:     ::1:45962 - "POST / HTTP/1.1" 200 OK
[06/26/25 18:30:10] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Reading resource:                     client.py:111
                             resource://agent_cards/planner_agent               
[06/26/25 18:30:15] INFO     SSE ClientSession initialized          client.py:55
                             successfully.                                      
                    INFO     Calling 'find_agent' tool with query:  client.py:92
                             'Book round-trip economy class air                 
                             tickets from San...'                               
